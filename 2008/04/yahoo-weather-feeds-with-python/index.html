
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Yahoo! Weather Feeds With Python - Uptonian Thoughts</title>
  <meta name="author" content="Thomas Upton">

  
  <meta name="description" content="A place where Thomas Upton talks about music, code, coffee, and anything else he fancies.">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.thomasupton.com/2008/04/yahoo-weather-feeds-with-python">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Uptonian Thoughts" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-332267-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Uptonian Thoughts</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.google.com/search?q=site%3Ablog.thomasupton.com" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.thomasupton.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Yahoo! Weather Feeds With Python</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-22T09:52:04-05:00" pubdate data-updated="true">April 22, 2008</time>
        
        &middot; <a href="">&infin;</a>
        &middot; 

<iframe border="0" scrolling="no" width="78" height="17" allowtransparency="true" frameborder="0"
 style="margin-bottom: -3px; z-index: 1338; border: 0px; background-color: transparent; overflow: hidden;"
 src="http://www.instapaper.com/e2?url=http://blog.thomasupton.com%2F%2F2008%2F04%2Fyahoo-weather-feeds-with-python&title=Yahoo!%20Weather%20Feeds%20With%20Python"
></iframe>

      </p>
    
  </header>


<div class="entry-content"><p><a href="http://github.com/tupton/python-yahoo-weather/tree/master">Download the weather script from GitHub.</a></p>

<p><strong>UPDATE:</strong> Chris Lasher updated my script. It now utilizes <a href="http://docs.python.org/lib/module-optparse.html">optparse</a> and docstrings. Some of the options have been changed, too, and I have licensed the code under a <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/us/">by-nc-sa CC license</a>.  I have updated this post to reflect these changes. Thanks, Chris!</p>

<p>I believe that everyone likes to know what the weather is like outside. In the good ol’ days, people used to stick a hand out of the window and know everything they needed to know about the weather; now we have <a href="http://www.google.com/search?q=weather%3A24060">myriad</a> <a href="http://www.wunderground.com/cgi-bin/findweather/getForecast?query=24060">options</a> to <a href="http://weather.yahoo.com/forecast/USVA0068.html">check</a> the <a href="http://forecast.weather.gov/MapClick.php?CityName=Blacksburg&amp;state=VA&amp;site=RNK&amp;textField1=37.2327&amp;textField2=-80.4284">weather</a>.</p>

<p>A few years ago, I was running <a href="http://widgets.yahoo.com/">Konfabulator</a> on Windows. The best widget for this application was the weather widget. I had a large weather widget that showed the current weather in the town in which I was currently residing, and some smaller weather widgets allowed me to keep tabs on the weather elsewhere.</p>

<p>When I got my Powerbook in 2004, I continued to use Konfabulator. With Tiger came <a href="http://www.apple.com/downloads/dashboard/">Dashboard</a> in 2005; I promptly started using the weather widgets provided by Dashboard. However, I realized that the requirement that I switch contexts to Dashboard just to quickly check small tidbits of information greatly distracted me from my workflow. Even the ability to display widgets directly on the desktop was no help; the pretty images take up too much screen real estate.</p>

<p>As I have <a href="http://thomas.fiveuptons.com/?p=197">written</a> about in the past, I utilize <a href="http://projects.tynsoe.org/en/geektool/">Geek Tool</a> on my desktop. One of the scripts I run scrapes the <a href="http://www.wunderground.com/">Weather Underground</a> XML feed for Blacksburg, VA and displays the current conditions. This works fine, but it isn’t very extensible. Weather Underground does not appear to have a feed API, so each city’s XML feed must be found manually and utilized in the script. Last night I decided that this was unacceptable.</p>

<p>Yahoo offers a great <a href="http://developer.yahoo.com/weather/">RSS-based API for its weather services</a>. Python has a <a href="http://docs.python.org/lib/module-xml.dom.minidom.html">built-in XML parser</a>. It doesn’t take a <a href="http://omnisio.com/startupschool08/david-heinemeier-hansson-at-startup-school-08">rocket surgeon</a> to put those two together. With a little <a href="http://developer.yahoo.com/python/python-xml.html">help from Yahoo’s Developer Network</a>, I was able to come up with a more robust script with which the weather can be displayed.</p>

<p>I learned a few things regarding Python while writing this script. The <a href="http://docs.python.org/lib/module-getopt.html">getopt() method</a> is a very useful command-line options and arguments parser. It’s very simple to define options for your script using this method.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">getopt</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">sys</span>
</span><span class="line">
</span><span class="line"><span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">getopt</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&quot;cflv&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now the options that were passed on the command line and that are part of <code>cflv</code> are in the <code>opts</code> array; command line arguments are listed in <code>args</code>.</p>

<p><strong>UPDATE:</strong> My script now uses <a href="http://docs.python.org/lib/module-optparse.html">optparse</a> instead of getopt.</p>

<p><a href="http://docs.python.org/lib/module-xml.dom.minidom.html">minidom</a> is a simple but complete DOM implementation. Using the <code>getElementsByTagName</code> and the <code>getAttribute</code> methods makes for easy and stress-free XML parsing.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">from</span> <span class="nn">xml.dom.minidom</span> <span class="kn">import</span> <span class="n">parse</span>
</span><span class="line">
</span><span class="line"><span class="n">dom</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s">&quot;file.xml&quot;</span><span class="p">)</span>
</span><span class="line">
</span><span class="line"><span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="line">
</span><span class="line"><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">dom</span><span class="o">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">&#39;tag&#39;</span><span class="p">):</span>
</span><span class="line">    <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s">&#39;text&#39;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>attrs</code> contains the <code>text</code> attribute of each <code>tag</code> node in the XML file <code>file.xml</code>.</p>

<p>I am currently looking into building this script on top of a Twitter model. Keep checking in for more information.</p>

<p>In order to run the script, pass it a zip code to find the weather.</p>

<pre><code>$ weather.py 24060
</code></pre>

<p>Running the script without any arguments will show the usage and the available options.</p>

<ul>
  <li><code>-c</code> Suppress the current weather output. Use this if you only want the forecast data.</li>
  <li><code>-f DAYS</code> Show the forecast for the next DAYS days.</li>
  <li><code>-l</code> Show the city and region name of the forecast that was retrieved. Use this to verify the zip code that you are using is in fact your area.</li>
  <li><code>-v</code> Print headers above all output.</li>
</ul>

<p>Here is some example output from the script:</p>

<p>Default options:</p>

<pre><code>$ weather.py 24060
55F | Drizzle
</code></pre>

<p>Forecast and location options:</p>

<pre><code>$ weather.py -lf2 24060
Blacksburg, VA

55F | Drizzle

22 Apr 2008
  Low: 50F
  High: 60F
  Condition: Few Showers

23 Apr 2008
  Low: 49F
  High: 71F
  Condition: AM Clouds/PM Sun
</code></pre>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Thomas Upton</span></span>

      








  


<time datetime="2008-04-22T09:52:04-05:00" pubdate data-updated="true">April 22, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/categories/articles/'>Articles</a>, <a class='category' href='/categories/code/'>Code</a>, <a class='category' href='/categories/software/'>Software</a>, <a class='category' href='/categories/webapps/'>Webapps</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2008/04/blogwatch" title="Previous Post: Blogwatch">&laquo; Blogwatch</a>
      
      
        <a class="basic-alignment right" href="/2008/04/blog-comment-design" title="Next Post: Blog Comment Design">Blog Comment Design &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/migrating-from-pathogen-to-vundle">Migrating from Pathogen to Vundle</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/quickly-convert-unix-timestamps">Quickly convert Unix timestamps</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/remove-leading-whitespace">Remove leading whitespace</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/batch-deleting-last-fm-scrobbles">Batch Deleting Last.fm Scrobbles</a>
      </li>
    
      <li class="post">
        <a href="/2012/07/duplicate-posts-in-the-feed">Duplicate Posts In The Feed</a>
      </li>
    
      <li class="post">
        <a href="/2012/07/octopress">Octopress</a>
      </li>
    
      <li class="post">
        <a href="/2012/07/reading-my-news">Reading My News</a>
      </li>
    
      <li class="post">
        <a href="/2012/07/aeropress">Aeropress</a>
      </li>
    
      <li class="post">
        <a href="/2012/06/knowing-the-rules">Knowing The Rules</a>
      </li>
    
      <li class="post">
        <a href="/2012/05/syntastic">Syntastic</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Thomas Upton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
